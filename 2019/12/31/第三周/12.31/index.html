<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>第三周/12.31 | 熊猫在路上</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="[toc] DOS命令DOS使用常识DOS的概况DOS（Disk Operating System）是一个使用得十分广泛的磁盘操作系统，就连眼下流行的Windows9x&#x2F;ME系统都是以它为基础。 常见的DOS有两种：IBM公司的PC-DOS和微软公司的MS-DOS，它们的功能、命令用途格式都相同，我们常用的是MS-DOS。 DOS常用命令dir    显示目录 path    设置可执行文件的搜索">
<meta property="og:type" content="article">
<meta property="og:title" content="第三周&#x2F;12.31">
<meta property="og:url" content="http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/index.html">
<meta property="og:site_name" content="熊猫在路上">
<meta property="og:description" content="[toc] DOS命令DOS使用常识DOS的概况DOS（Disk Operating System）是一个使用得十分广泛的磁盘操作系统，就连眼下流行的Windows9x&#x2F;ME系统都是以它为基础。 常见的DOS有两种：IBM公司的PC-DOS和微软公司的MS-DOS，它们的功能、命令用途格式都相同，我们常用的是MS-DOS。 DOS常用命令dir    显示目录 path    设置可执行文件的搜索">
<meta property="og:locale" content="ch">
<meta property="article:published_time" content="2019-12-31T01:05:20.653Z">
<meta property="article:modified_time" content="2019-12-31T10:04:35.057Z">
<meta property="article:author" content="熊猫在路上">
<meta name="twitter:card" content="summary">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">熊猫在路上</h5>
          <a href="mailto:2439046455@qq.com" title="2439046455@qq.com" class="mail">2439046455@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/xiongmaoyan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">第三周/12.31</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">第三周/12.31</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-12-31T01:05:20.653Z" itemprop="datePublished" class="page-time">
  2019-12-31
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#DOS命令"><span class="post-toc-number">1.</span> <span class="post-toc-text">DOS命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DOS使用常识"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">DOS使用常识</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DOS的概况"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">DOS的概况</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DOS常用命令"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">DOS常用命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看服务"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">查看服务</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看端口"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">查看端口</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#渗透相关命令"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">渗透相关命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#域渗透命令"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">域渗透命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#内网渗透思路"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">内网渗透思路</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#绕过注入整理"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">绕过注入整理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#渗透大牛思路"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">渗透大牛思路</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#关于漏洞复现"><span class="post-toc-number">1.3.5.</span> <span class="post-toc-text">关于漏洞复现</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#关于文件隐藏"><span class="post-toc-number">2.</span> <span class="post-toc-text">关于文件隐藏</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#驱动级的文件隐藏"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">驱动级的文件隐藏</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件隐藏的部分原理"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">文件隐藏的部分原理</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#powershell"><span class="post-toc-number">3.</span> <span class="post-toc-text">powershell</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#powershell的使用"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">powershell的使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#启动PowerShell"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">启动PowerShell</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用powershell"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">使用powershell</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#powershell的命令"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">powershell的命令</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#powershell渗透工具"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">powershell渗透工具</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-第三周/12.31"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">第三周/12.31</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-31 09:05:20" datetime="2019-12-31T01:05:20.653Z"  itemprop="datePublished">2019-12-31</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>[toc]</p>
<h1 id="DOS命令"><a href="#DOS命令" class="headerlink" title="DOS命令"></a>DOS命令</h1><h2 id="DOS使用常识"><a href="#DOS使用常识" class="headerlink" title="DOS使用常识"></a>DOS使用常识</h2><h3 id="DOS的概况"><a href="#DOS的概况" class="headerlink" title="DOS的概况"></a>DOS的概况</h3><p>DOS（Disk Operating System）是一个使用得十分广泛的磁盘操作系统，就连眼下流行的Windows9x/ME系统都是以它为基础。</p>
<p>常见的DOS有两种：IBM公司的PC-DOS和微软公司的MS-DOS，它们的功能、命令用途格式都相同，我们常用的是MS-DOS。</p>
<h2 id="DOS常用命令"><a href="#DOS常用命令" class="headerlink" title="DOS常用命令"></a>DOS常用命令</h2><p>dir    显示目录</p>
<p>path    设置可执行文件的搜索路径，只对文件有效，只一次性生效</p>
<p>tree /a /f    打印文件树形结构</p>
<p>tasklist    显示进程</p>
<p>netstat -ano 显示端口信息</p>
<p>ver winver    显示系统版本</p>
<p>cls    清屏</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">net use \\ip\ipc$ &quot; &quot; &#x2F;user:&quot; &quot; 建立ipc空链接</span><br><span class="line"></span><br><span class="line">net use \\ip\ipc$ &quot;密码&quot; &#x2F;user:&quot;用户名&quot; 建立ipc非空链接</span><br><span class="line"></span><br><span class="line">net use h: \\ip\c$ &quot;密码&quot; &#x2F;user:&quot;用户名&quot; 直接登陆后映射对方c：到本地为h:</span><br><span class="line"></span><br><span class="line">net use h: \\ip\c$ 登陆后映射对方c：到本地为h:</span><br><span class="line"></span><br><span class="line">net use \\ip\ipc$ &#x2F;del 删除ipc链接</span><br><span class="line"></span><br><span class="line">net use h: &#x2F;del 删除映射对方到本地的为h：的映射</span><br><span class="line"></span><br><span class="line">net user 用户名 密码 &#x2F;add 建立用户</span><br><span class="line"></span><br><span class="line">net user guest &#x2F;active:yes 激活guest用户</span><br><span class="line"></span><br><span class="line">net user 查看有哪些用户</span><br><span class="line"></span><br><span class="line">net user 帐户名 查看帐户的属性</span><br><span class="line"></span><br><span class="line">net localgroup ***istrators 用户名 &#x2F;add 把“用户”添加到管理员中使其具有管理员权限，注意：***istrator后加s用复数</span><br><span class="line"></span><br><span class="line">net time \\目标ip 查看对方时间</span><br><span class="line"></span><br><span class="line">net time \\目标ip &#x2F;set 设置本地计算机时间与“目标ip”主机的时间同步，加上参数&#x2F;yes可取消确认信息</span><br><span class="line"></span><br><span class="line">net view 查看本地局域网内开启了哪些共享</span><br><span class="line"></span><br><span class="line">net view \\ip 查看对方局域网内开启了哪些共享</span><br><span class="line"></span><br><span class="line">net config 显示系统网络设置</span><br><span class="line"></span><br><span class="line">net logoff 断开连接的共享</span><br><span class="line"></span><br><span class="line">net pause 服务名 暂停某服务</span><br><span class="line"></span><br><span class="line">net send ip &quot;文本信息&quot; 向对方发信息</span><br><span class="line"></span><br><span class="line">net ver 局域网内正在使用的网络连接类型和信息</span><br><span class="line"></span><br><span class="line">net share 查看本地开启的共享</span><br><span class="line"></span><br><span class="line">net share ipc$ 开启ipc$共享</span><br><span class="line"></span><br><span class="line">net share ipc$ &#x2F;del 删除ipc$共享</span><br><span class="line"></span><br><span class="line">net share c$ &#x2F;del 删除c：共享</span><br><span class="line"></span><br><span class="line">net user guest 12345 用guest用户登陆后用将密码改为12345net password 密码 更改系统登陆密码</span><br><span class="line"></span><br><span class="line">nbtstat -a ip 对方136到139其中一个端口开了的话，就可查看对方最近登陆的用户名（03前的为用户名）-注意：参数-a要大写</span><br><span class="line"></span><br><span class="line">tracert -参数 ip（或计算机名） 跟踪路由（数据包），参数：“-w数字”用于设置超时间隔。</span><br><span class="line"></span><br><span class="line">ping ip（或域名） 向对方主机发送默认大小为32字节的数据，参数：“-l[空格]数据包大小”；“-n发送数据次数”；“-t”指一直ping。</span><br><span class="line"></span><br><span class="line">ping -t -l 65500 ip 死亡之ping（发送大于64k的文件并一直ping就成了死亡之ping)</span><br><span class="line"></span><br><span class="line">ipconfig (winipcfg) 用于windows nt及xp(windows 95 98）查看本地ip地址，</span><br><span class="line"></span><br><span class="line">ipconfig可用参数“&#x2F;all”显示全部配置信息</span><br><span class="line"></span><br><span class="line">tlist -t 以树行列表显示进程（为系统的附加工具，默认是没有安装的，在安装目录的support&#x2F;tools文件夹内）</span><br><span class="line"></span><br><span class="line">kill -f 进程名 加-f参数后强制结束某进程（为系统的附加工具，默认是没有安装的，在安装目录的support&#x2F;tools文件夹内）</span><br><span class="line"></span><br><span class="line">del -f 文件名加-f参数后就可删除只读文件,&#x2F;ar、&#x2F;ah、&#x2F;as、&#x2F;aa分别表示删除只读、隐藏、系统、存档文件，&#x2F;a-r、&#x2F;a-h、&#x2F;a-s、&#x2F;a-a表示删除除只读、隐藏、系统、存档以外的文件。例如“del&#x2F;ar *.*”表示删除当前目录下所有只读文件，“del&#x2F;a-s *.*”表示删除当前目录下除系统文件以外的所有文件</span><br><span class="line"></span><br><span class="line"> TASKKILL &#x2F;IM notepad.exe</span><br><span class="line"> TASKKILL &#x2F;PID 1230 &#x2F;PID 1241 &#x2F;PID 1253 &#x2F;T</span><br><span class="line"> TASKKILL &#x2F;F &#x2F;IM cmd.exe &#x2F;T</span><br><span class="line"> TASKKILL &#x2F;F &#x2F;FI &quot;PID ge 1000&quot; &#x2F;FI &quot;WINDOWTITLE ne untitle*&quot;</span><br><span class="line"> TASKKILL &#x2F;F &#x2F;FI &quot;USERNAME eq NT AUTHORITY\SYSTEM&quot; &#x2F;IM notepad.exe</span><br><span class="line"> TASKKILL &#x2F;S system &#x2F;U domain\username &#x2F;FI &quot;USERNAME ne NT*&quot; &#x2F;IM *</span><br><span class="line"> TASKKILL &#x2F;S system &#x2F;U username &#x2F;P password &#x2F;FI &quot;IMAGENAME eq note*&quot;</span><br></pre></td></tr></table></figure>

<h3 id="查看服务"><a href="#查看服务" class="headerlink" title="查看服务"></a>查看服务</h3><p>SC 是用于与服务控制管理器和服务进行通信的命令行程序。</p>
<p>查询服务状态</p>
<p><strong>sc qc 服务名</strong></p>
<p>停止服务</p>
<p><strong>net stop 服务名</strong></p>
<p>删除服务</p>
<p><strong>sc delete 服务名</strong></p>
<h3 id="查看端口"><a href="#查看端口" class="headerlink" title="查看端口"></a>查看端口</h3><p>net start 查看开启了哪些服务net start 服务名 开启服务；（如：net start telnet，</p>
<p>net start schedule)net stop 服务名 停止某服务</p>
<p>netstat -a 查看开启了哪些端口，常用</p>
<p>netstat -annetstat -n 查看端口的网络连接情况，常用</p>
<p>netstat -annetstat -v 查看正在进行的工作</p>
<p>netstat -p 协议名 例：netstat -p tcp/ip 查看某协议使用情况（查看tcp/ip协议使用情况）</p>
<p>netstat -s 查看正在使用的所有协议使用情况</p>
<h2 id="渗透相关命令"><a href="#渗透相关命令" class="headerlink" title="渗透相关命令"></a>渗透相关命令</h2><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>arp -a</td>
<td>查看最近一次arp得到的局域网中的主机</td>
</tr>
<tr>
<td>systeminfo</td>
<td>查看主机的详细信息（包含已经打过的补丁）</td>
</tr>
<tr>
<td>cls</td>
<td>清屏</td>
</tr>
<tr>
<td>color XY</td>
<td>调整cmd窗口的颜色，X调整的是背景颜色，Y调整的是字体的颜色。具体颜色的代表符号可用 color –help 查询。当只有一个选项时调整的字体的颜色。</td>
</tr>
<tr>
<td>net view</td>
<td>查看局域网中的主机名</td>
</tr>
<tr>
<td>msg</td>
<td>向电脑中某个账户发消息。如：msg xxx “Hello”  xxx代表的是账户的名称。</td>
</tr>
<tr>
<td>ipconfig</td>
<td>查看主机的IP信息</td>
</tr>
<tr>
<td>shutdown</td>
<td>shutdown -s -t X -c “Hello” 执行定时关机命令并且显示Hello，X代表剩余关机的秒数，如果不想显示可不用 -c ，shutdown -a 取消定时关机。</td>
</tr>
<tr>
<td>netstat</td>
<td>查看本机各端口的连接情况，netstat -an 能够显示所有的连接和端口号。</td>
</tr>
<tr>
<td>dir</td>
<td>查看当前的目录，如果带有<dir>代表的是文件夹，没有代表的是文件。</td>
</tr>
<tr>
<td>start</td>
<td>打开某个文件（会自动判断用什么打开），但是名字要打全，可用tab键补全。</td>
</tr>
<tr>
<td>copy</td>
<td>复制命令，格式：copy X:\xxx d:\ 将X盘的xxx复制到d盘下。</td>
</tr>
<tr>
<td>del</td>
<td>删除命令，格式: del d:\xxx 将d盘下的xxx删除。</td>
</tr>
<tr>
<td>md</td>
<td>创建文件夹，可以递归创建。</td>
</tr>
<tr>
<td>rd</td>
<td>删除文件夹 ，递归删除文件夹格式: rd /s /q d:\xxx\xx\x  ,用递归删除命令的时候可以不加 /q 加上/q的话再删除的时候不用确认。</td>
</tr>
<tr>
<td>copy con</td>
<td>创建文件后能够在cmd中直接写文件，写完之后CTRL+z 退出。</td>
</tr>
<tr>
<td>type</td>
<td>在命令行中查看文件</td>
</tr>
<tr>
<td>ren</td>
<td>重命名，格式：ren 原文件名字 新文件名字</td>
</tr>
<tr>
<td>move</td>
<td>移动文件，格式: move s:\xxx.txt d:\  将s盘下的xxx.txt 移动到d盘</td>
</tr>
<tr>
<td>tree</td>
<td>查看树形结构</td>
</tr>
<tr>
<td>telent</td>
<td>远程连接，如果显示错误是本地的telnet客户端没有安装。解决方案：win+R—control—程序—启用或者关闭windows功能—找到telnet客户端（记住是客户端！！）—勾选—确定。格式：telnet IP地址</td>
</tr>
<tr>
<td>net start</td>
<td>查看已经打开的服务</td>
</tr>
<tr>
<td>net user</td>
<td>查看电脑创建的用户。 net user xx password /add 添加xxx用户密码为password。</td>
</tr>
<tr>
<td>net localgroup</td>
<td>查看当前的用户组有哪些。用法： net localgroup Administrators xxx /add 将xxx添加到管理员组。</td>
</tr>
<tr>
<td>net use</td>
<td>磁盘映射。 格式：net use K:\ 目的ip\c:$将目的ip电脑的c盘映射到本地为k盘。</td>
</tr>
<tr>
<td>taskkill</td>
<td>查看系统进程。taskkill /im xxx  将xxx进程结束。</td>
</tr>
<tr>
<td>schtasks.exe(at)</td>
<td>查看系统计划。我的电脑显示at命令已经弃用。</td>
</tr>
<tr>
<td>attrib</td>
<td>查看文件的属性。</td>
</tr>
</tbody></table>
<h3 id="域渗透命令"><a href="#域渗透命令" class="headerlink" title="域渗透命令"></a>域渗透命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">内网渗透</span><br><span class="line">https:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;193431</span><br></pre></td></tr></table></figure>



<p>ipconfig /all</p>
<p>//可以查看到当前网卡配置信息，包括所属域以及IP段</p>
<p>net view /domain:testdomain（testdomain 假设为目标的其中一个域）</p>
<p>//此命令是查看 testdomain域中的计算机列表</p>
<p>net view</p>
<p>//显示正由指定的计算机共享的域、计算机或资源的列表。如果在没有参数的情况下使用，则 net view 显示当前域中的计算机列表。</p>
<p>ping 机器名</p>
<p>//显示该机器名的IP</p>
<p>net view /domain</p>
<p>//查看有多少域</p>
<p>net user /domain</p>
<p>//获取所有域用户列表</p>
<p>net group /domain</p>
<p>//获取域用户组信息</p>
<p>net group “domain admins” /domain</p>
<p>//获取当前域管理员列表</p>
<p>net user domain-admin /domain</p>
<p>//查看管理员登陆时间，密码过期时间，是否有登陆脚本，组分配等信息！</p>
<p>net time /domain</p>
<p>//可以查看域时间，以及域服务器的名字（快速查找域的方法之一 By LCX）</p>
<p>net user /domain</p>
<p>//显示所有域用户</p>
<p>net user hack hack /add /domain</p>
<p>//添加普通域用户</p>
<p>net group “Domain Admins” hack /add /domain</p>
<p>//将 普通域用户 提升为域管理员</p>
<p>query user</p>
<p>查看是否有管理员在线</p>
<p>输入命令：logoff 1<br>把id为1的管理员踢下线（就是注销）</p>
<h3 id="内网渗透思路"><a href="#内网渗透思路" class="headerlink" title="内网渗透思路"></a>内网渗透思路</h3><p>攻击者做内网渗透时，思路通常是先获取了工作组的administrator权限，然后渗透配置不严格的域环境，开启powershell的remoting功能，powershell 2.0的Remoting默认会走<code>5985(HTTP)</code>和<code>5986(HTTPS)</code>端口，文章里说，主要是监控内网&lt;-&gt;内网，DMZ&lt;-&gt;内网,VPN&lt;-&gt;内网的异常数据流，建模识别出攻击者的非法访问，我想这里能做的，还是要熟悉内网环境，在有正常业务流的内网使用Remoting功能，其他办法我也没想到。</p>
<h3 id="绕过注入整理"><a href="#绕过注入整理" class="headerlink" title="绕过注入整理"></a>绕过注入整理</h3><p>参考</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;devi1o&#x2F;articles&#x2F;4896854.html</span><br></pre></td></tr></table></figure>


<p>and update delete ; insert mid master<br>1、运用编码技术绕过<br>如URLEncode编码，ASCII编码绕过。例如or 1=1即<br>%6f%72%20%31%3d%31，而Test也可以为CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)。</p>
<p>2、通过空格绕过<br>如两个空格代替一个空格，用Tab代替空格等，或者删除所有空格，如<br>or’ swords’ =‘swords’ 必须用字符串，否则不用空格会出错<br>3、运用字符串判断代替<br>用经典的or 1=1判断绕过,如<br>or ‘swords’ =’swords’</p>
<p>这个方法就是网上在讨论的。<br>4、通过类型转换修饰符N绕过<br>可以说这是一个不错的想法，他除了能在某种程度上绕过限制，而且还有别的作用，大家自己好好想想吧。关于利用，如or ‘swords’ = N’ swords’ ，大写的N告诉mssql server 字符串作为nvarchar类型，它起到类型转换的作用，并不影响注射语句本身，但是可以避过基于知识的模式匹配IDS。<br>5、通过+号拆解字符串绕过<br>效果值得考证，但毕竟是一种方法。如<br>or ‘swords’ =‘sw’ +’ ords’ ；EXEC(‘IN’ +’ SERT INTO ‘+’ …..’ )</p>
<p>6、通过LIKE绕过<br>以前怎么就没想到呢?如or<br>‘swords’ LIKE ‘sw’</p>
<p>显然可以很轻松的绕过<br>“=”“&gt;”</p>
<p>的限制……<br>7、通过IN绕过<br>与上面的LIKE的思路差不多,如<br>or ‘swords’ IN (‘swords’)</p>
<p>8、通过BETWEEN绕过<br>如<br>or ‘swords’ BETWEEN ‘rw’ AND ‘tw’</p>
<p>9、通过&gt;或者&lt;绕过<br>or ‘swords’ &lt; ‘tw’<br>or 1&lt;3</p>
<p>……<br>10、运用注释语句绕过<br>用/<strong>/代替空格，如：<br>UNION /</strong>/ Select /**/user，pwd，from tbluser</p>
<p>用/<strong>/分割敏感词，如：<br>U/</strong>/ NION /<strong>/ SE/</strong>/ LECT /**/user，pwd from tbluser</p>
<p>11、用HEX绕过，一般的IDS都无法检测出来<br>0x640062005F006F0077006E0065007200 =hex(db_owner)</p>
<p>另外，关于通用点的过滤方法，我们可以考虑采用赋值的方法，例如先声明一个变量a，然后把我们的指令赋值给a，然后调用变量a最终执行我们输入的命令。变量a可以是任何命令。如下：<br>declare @a sysname<br>select @a=<br>exec master.dbo.xp_cmdshell @a</p>
<p>效果<br><a href="http://www.ilikeplmm.com/show.asp?id=1;declare%20@a%" target="_blank" rel="noopener">http://www.ilikeplmm.com/show.asp?id=1;declare%20@a%</a> 20sysname%20select%20@a=0x6e006500740020007500730065007200200061006e00670065006c002000700061007300730020002f00610064006400%20exec%20master.dbo.xp_cmdshell%20@a;-</p>
<p>1、运用编码技术绕过<br>如URLEncode编码，ASCII编码绕过。例如or 1=1即%6f%72%20%31%3d%31，而Test也可以为CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)。</p>
<p>2、通过空格绕过<br>如两个空格代替一个空格，用Tab代替空格等，或者删除所有空格，如<br>or swords =‘swords，由于mssql的松散性，我们可以把or swords 之间的空格去掉，并不影响运行。</p>
<p>3、运用字符串判断代替<br>用经典的or 1=1判断绕过,如or swords =swords，这个方法就是网上在讨论的。</p>
<p>4、通过类型转换修饰符N绕过<br>可以说这是一个不错的想法，他除了能在某种程度上绕过限制，而且还有别的作用，大家自己好好想想吧。关于利用，如or swords = N swords ，大写的N告诉mssql server 字符串作为nvarchar类型，它起到类型转换的作用，并不影响注射语句本身，但是可以避过基于知识的模式匹配IDS。</p>
<p>5、通过+号拆解字符串绕过<br>效果值得考证，但毕竟是一种方法。如or swords =‘sw + ords ；EXEC(‘IN + SERT INTO + ….. )</p>
<p>6、通过LIKE绕过<br>以前怎么就没想到呢？如orswords LIKE sw！！！显然可以很轻松的绕过“=”“&gt;”的限制……</p>
<p>7、通过IN绕过<br>与上面的LIKE的思路差不多,如or swords IN (swords)</p>
<p>8、通过BETWEEN绕过<br>如or swords BETWEEN rw AND tw</p>
<p>9、通过&gt;或者&lt;绕过<br>or swords &gt; sw<br>or swords &lt; tw<br>or 1&lt;3<br>……</p>
<p>10、运用注释语句绕过<br>用/<strong>/代替空格，如：UNION /</strong>/ Select /<strong>/user，pwd，from tbluser<br>用/</strong>/分割敏感词，如：U/<strong>/ NION /</strong>/ SE/<strong>/ LECT /</strong>/user，pwd from tbluser</p>
<p>11、用HEX绕过，一般的IDS都无法检测出来<br>0x730079007300610064006D0069006E00 =hex(sysadmin)<br>0x640062005F006F0077006E0065007200 =hex(db_owner)</p>
<p>12、大小写互换绕过<br>select 可以写成 SelEct<br>union 可以写成 UnIoN</p>
<p>13、多种编码组合绕过<br>常用的有BASE64、ASC、SQL、HEX、URL编码</p>
<p>14、利用中转工具绕过<br>可以利用刺猬的中转工具来绕过</p>
<p>15、利用特殊字符填充绕过<br>这些特殊字符，会被解释成空格，方式和通过空格绕过一样的，一般用来绕过第三方防火墙软件</p>
<dl><dt>16、改变攻击方式<br>如果get提交实在无法绕过，可以尝试改变攻击方式。如；post注入、寻找子站、旁站……等<br>过安全狗：and ‘1’ in(‘1’)<br>空格 - %20<br>“ - %22<br># - %23<br>% - %25<br>&amp; - %26<br>( - %28<br>) - %29<br>+ - %2B<br>, - %2C<br>/ - %2F</dt><dd>- %3A<br>; - %3B<br>&lt; - %3C<br>= - %3D<br>&gt; - %3E<br>? - %3F<br>@ - %40<br>\ - %5C<br>| - %7C</dd></dl><h3 id="渗透大牛思路"><a href="#渗透大牛思路" class="headerlink" title="渗透大牛思路"></a>渗透大牛思路</h3><p>（一）针对网站程序，不考虑服务器。</p>
<p>一、查找注入，注意数据库用户权限和站库是否同服。</p>
<p>二、查找XSS，最近盲打很流行，不管怎样我们的目的是进入后台。</p>
<p>三、查找上传，一些能上传的页面，比如申请友链、会员头像、和一些敏感页面等等，注意查看验证方式是否能绕过，注意结合服务器的解析特性，比如典型的IIS6.0、阿帕奇等。</p>
<p>四、查找编辑器，比较典型的ewebeditor、fckeditor等等。</p>
<p>五、查找phpmyadmin等管理程序，可以尝试弱口令，或者寻找其漏洞。</p>
<p>六、百度、谷歌搜索程序公开漏洞。</p>
<p>七、猜解文件，如知道某文件为admin_login.php,我们可尝试admin_add.php、admin_upload.php文件是否存在，也可以谷歌搜索site:cnseay.com inurl:edit等等，很多时候可以找到一些敏感文件，接着看是否验证权限或能否绕过验证，这像冰风说高级语法。</p>
<p>八、会员注册、修改、删除、评论等一切需要操作数据库的地方记得加单引号之类查看是否存在insert、update等类型注入。</p>
<p>九、会员或低权限管理登陆后可抓包分析，尝试修改超级管理员密码，权限提升。</p>
<p>十、通常有下载功能的站我们可以尝试修改下URL文件名，看能否下载站点敏感文件，如数据库配置文件等，数据库不可外连情况下可以尝试数据库密码登陆后台，也可下载上传、登陆验证等文件进行代码审计。</p>
<p>十一、备份文件和后门，某些主站子目录存在分站，比如<a href="http://www.cnseay.com/seay/，我们可以尝试www.cnseay.com/seay.rar/zip等压缩文件是否存在，可能就是子站的源码。也有一些站类似这样www.cnseay.com/old/，一般都是以前的老站，通常老站会比较容易拿。还有就是数据库备份、前人的后门等，具体这些目录上的东西就要看你的字典了。" target="_blank" rel="noopener">www.cnseay.com/seay/，我们可以尝试www.cnseay.com/seay.rar/zip等压缩文件是否存在，可能就是子站的源码。也有一些站类似这样www.cnseay.com/old/，一般都是以前的老站，通常老站会比较容易拿。还有就是数据库备份、前人的后门等，具体这些目录上的东西就要看你的字典了。</a></p>
<p>十二、0day漏洞，不管是别人给你的，还是自己挖的，总之好使就行。</p>
<p>十三、。。。</p>
<p>（二）针对服务器</p>
<p>一、通常先扫下服务器开放的端口，再考虑对策。</p>
<p>二、比较常见的解析漏洞，比如IIS6.0、阿帕奇、nginx/IIS7.0(php-fpm)解析漏洞等，还有就是cer、asa之类的解析，.htaccess文件解析配置等。</p>
<p>三、弱口令和everyone权限，先扫描服务器开放的端口，比如21对应的FTP、1433对应的MSSQL、3306对应的MYSQL、3389对应的远程桌面、1521对应的Oracle等等，平时可以多搜集下字典，有时候效果也是不错的(通常在cain嗅探的时候，经常能嗅到别人不停的扫…很蛋疼)。</p>
<p>四、溢出，这点要看系统补丁和服务器使用的软件等等，比如FTP等工具，这里不详解。</p>
<p>五、针对一些服务器管理程序，比如tomcat、jboss等等，这种比较常见于大中型的站点服务器。</p>
<p>六、IIS、apache等各种漏洞，这个要平时多关注。</p>
<p>七、目录浏览，服务器配置不当，可直接浏览目录。</p>
<p>八、共享…</p>
<p>九、。。。<br>（三）针对人，社工</p>
<p>社工在渗透中通常能起到惊人的效果，主要还是利用人的弱点，博大精深，这里不详细讨论，注意平时多看一些社工文章，学习一些思路、技巧。</p>
<p>（四）迂回战术，旁注和C段</p>
<p>一、旁注，针对旁站，我们可以运用到上面说到的方法，这里不多说。</p>
<p>二、C段，基本想到C段就会想到cain，针对C段的站点和服务器，结合上面说的针对目标站、服务器、人、旁站的思路，一个道理，当然如果你的目的仅仅是黑站的话，不妨试试NetFuke之类。</p>
<p>三、…<br>（五）提权常用手段</p>
<p>一、使用系统溢出提权EXP，这类在提权中最常用，使用的方法大都一致，比如比较常见的巴西烤肉、pr等等，溢出提权通常在Linux上也利用的比较多，注意多收集EXP。</p>
<p>二、第三方软件提权，主要还是利用服务器上安装的第三方软件拥有比较高的权限，或者软件的溢出漏洞，比如典型的mssql、mysql、serv-u等等，还有各种远程控制软件，比如pcanywhere、Radmin这类。</p>
<p>三、劫持提权，说到这个，想必肯定会想到lpk.dll这类工具，有时候在蛋疼怎么都加不上账户的时候，可以试试劫持shift、添加开机启动等等思路。</p>
<p>四、弱口令技巧，我们可以看看有木有什么hack、或者隐藏账户之类的，一般这种用户密码都比较简单，可以尝试下弱口令，还有之前说过的各种数据库、远程控制软件、FTP软件的弱口令，没办法的时候就去扫扫碰碰运气吧。</p>
<p>五、信息收集，注意翻下硬盘各种文档，说不定各种密码就在里面。在内网渗透时，信息收集是非常重要的，记得拿下服务器了GET一下明文密码，德国那个mimikatz不错，还有就是域、ARP。。。貌似扯多跑题了。</p>
<p>六、社工…不多说。</p>
<h3 id="关于漏洞复现"><a href="#关于漏洞复现" class="headerlink" title="关于漏洞复现"></a>关于漏洞复现</h3><p>cve-2019-0708</p>
<p>通过3389的udp打蓝屏</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cve-2019-11043</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;yankaohaitaiwei&#x2F;p&#x2F;11795972.html</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;www.secpulse.com&#x2F;archives&#x2F;117525.html</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;cloud.tencent.com&#x2F;developer&#x2F;article&#x2F;1530703</span><br><span class="line"></span><br><span class="line">cve-2019-14287 sudo提权漏洞</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;mark-zh&#x2F;p&#x2F;11679015.html</span><br><span class="line"></span><br><span class="line">cve-2018-13024</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;www.freebuf.com&#x2F;news&#x2F;193748.html</span><br></pre></td></tr></table></figure>



<h1 id="关于文件隐藏"><a href="#关于文件隐藏" class="headerlink" title="关于文件隐藏"></a>关于文件隐藏</h1><h2 id="驱动级的文件隐藏"><a href="#驱动级的文件隐藏" class="headerlink" title="驱动级的文件隐藏"></a>驱动级的文件隐藏</h2><p>有如下特征：<br>系统目录存在如下文件:<br>c:\WINDOWS\xlkfs.dat<br>c:\WINDOWS\xlkfs.dll<br>c:\WINDOWS\xlkfs.ini<br>c:\WINDOWS\system32\drivers\xlkfs.sys</p>
<p>此驱动级隐藏文件会在服务项增加一个xlkfs的服务<br>驱动文件路径为：c:\WINDOWS\system32\drivers\xlkfs.sys<br>配置文件路径为：c:\WINDOWS\xlkfs.ini（<strong>这里会注明隐藏文件的路径</strong>）</p>
<p><strong>清理：</strong></p>
<p>1、查询服务状态：sc qc xlkfs</p>
<p>2、停止服务：net stop xlkfs</p>
<p>3、删除服务：sc delete xlkfs</p>
<p>4、删除系统目录下面的文件</p>
<p>5、重启系统，确认服务已经被清理了</p>
<h2 id="文件隐藏的部分原理"><a href="#文件隐藏的部分原理" class="headerlink" title="文件隐藏的部分原理"></a>文件隐藏的部分原理</h2><p>常见的文件夹加密方法被我归纳为以下4种：</p>
<ul>
<li><p>利用windows系统特殊的保留文件名后缀，使文件夹无法打开和删除。<br>例如类似1.{20D04FE0-3AEA-1069-A2D8-08002B30309D}等文件夹名称。</p>
</li>
<li><p>利用回收站特点，将文件夹保存在回收站，然后创建创建名为recycle或者RECYCLED的伪回收站。</p>
</li>
<li><p>直接将系统—文件夹的对应关系破坏，<br>在系统中留下一个没有文件实际地址的文件目录，<br>而在加密软件中则保存该文件夹的实际地址。</p>
</li>
<li><p>通过系统驻留程序监控被加密的文件夹，如果需打开，则提示输入密码，而实际上并没有对文件进行加密。</p>
</li>
</ul>
<p>以上<br>第1种方法大概是最常见的方法之一，容易实现，也最容易破解。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">首先是新建文件夹命名为以下名字，再重命名在前面加上xxxx.，即可完成伪装</span><br><span class="line"></span><br><span class="line">现在网上流行的文件夹加密软件比较多,他们其实是将文件夹伪装成系统文件，只需要在要加密的文件夹后面加一个如以下代码的扩展名即可实现。</span><br><span class="line">管理工具</span><br><span class="line">&#123;D20EA4E1-3957-11d2-A40B-0C5020524153&#125;</span><br><span class="line">公文包</span><br><span class="line">&#123;85BBD92O-42A0-1O69-A2E4-08002B30309D&#125;</span><br><span class="line">控制面板</span><br><span class="line">&#123;21EC2O2O-3AEA-1O69-A2DD-08002b30309d&#125;</span><br><span class="line">字体</span><br><span class="line">&#123;D20EA4E1-3957-11d2-A40B-0C5020524152&#125;</span><br><span class="line">历史记录</span><br><span class="line">&#123;FF393560-C2A7-11CF-BFF4-444553540000&#125;</span><br><span class="line">收件箱</span><br><span class="line">&#123;00020D75-0000-0000-C000-000000000046&#125;</span><br><span class="line">Microsoft网络</span><br><span class="line">&#123;00028B00-0000-0000-C000-000000000046&#125;</span><br><span class="line">我的电脑</span><br><span class="line">&#123;20D04FE0-3AEA-1069-A2D8-08002B30309D&#125;</span><br><span class="line">我的文档</span><br><span class="line">&#123;450D8FBA-AD25-11D0-98A8-0800361B1103&#125;</span><br></pre></td></tr></table></figure>

<p>第2种方法也比较容易破解。国内2大著名的加密软件都使用这方法。<br>第3种方法对于不了解原理的人来说应该有一定难度。<br>第4种方法首先要杀死进程才能进一步进行破解。<br>我想如果结合以上第3、4种方法做为家用加密软件还是比较有实用价值的吧…………</p>
<h1 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h1><p>Power是一个功能强大的shell，从面向用户而言，个人觉得其功能强大体现在以下几方面：</p>
<p>（1） 微软态度。微软是真正的在推行PowerShell，包括Office等更多自家软件，底层都是调用PowerShell来实现。</p>
<p>（2） 兼容性cmd。PowerShell包含原先cmd的所有命令，原先命令使用形式不变，在是在其基础上添加命令。</p>
<p>（3） 对标Linux。PowerShell使用了Linux Shell的思想，也就是所有的系统操作、配置，都可以在shell中敲写命令实现。</p>
<p>（4） 统一的命令格式和自包含的文档。</p>
<h2 id="powershell的使用"><a href="#powershell的使用" class="headerlink" title="powershell的使用"></a>powershell的使用</h2><h3 id="启动PowerShell"><a href="#启动PowerShell" class="headerlink" title="启动PowerShell"></a>启动PowerShell</h3><p>方法一： 直接在cmd中执行powershell，切换为powershell</p>
<p>方法二： 开始菜单中输入powershell启动powershell</p>
<p>方法三： 开始菜单—-附件—-powershell启动</p>
<p>带x86的是32位的，不带的是64位的；带ies的是简单的ide</p>
<h3 id="使用powershell"><a href="#使用powershell" class="headerlink" title="使用powershell"></a>使用powershell</h3><ul>
<li><p>get-help查看帮助（get-help 想要获取帮助的命令）</p>
</li>
<li><p>get-command查看有哪些命令</p>
<ul>
<li>CommandType列，表示命令类型，Alias是别名、Cmdlet是powershell格式的命令、Function是函数</li>
<li>Name列，就是命令</li>
<li>Definition列，命令功能的简单描述</li>
</ul>
</li>
<li><p>get-command缩小范围</p>
<ul>
<li>get-command get-*列出了所有get开头的命令</li>
<li>get-process的命令，获取进程信息的，get-process -name *typora</li>
</ul>
</li>
<li><p>stop-process -id pid杀除命令</p>
</li>
</ul>
<h2 id="powershell的命令"><a href="#powershell的命令" class="headerlink" title="powershell的命令"></a>powershell的命令</h2><p>　<strong>入门级别</strong></p>
<p>　　1. 像文件系统那样操作Windows Registry——cd hkcu:（切换到注册表）<br>　　2. 在文件里递回地搜索某个字符串——dir –r | select string “searchforthis”<br>　　3. 使用内存找到五个进程——ps | sort –p ws | select –last 5<br>　　4. 循环（停止，然后重启）一个服务，如DHCP——Restart-Service DHCP<br>　　5. 在文件夹里列出所有条目——Get-ChildItem – Force<br>　　6. 递归一系列的目录或文件夹——Get-ChildItem –Force c:\directory –Recurse<br>　　7. 在目录里移除所有文件而不需要单个移除——Remove-Item C:\tobedeleted –Recurse<br>  8. 重启当前计算机——(Get-WmiObject -Class Win32_OperatingSystem -ComputerName .).Win32Shutdown(2)</p>
<pre><code>**收集信息**</code></pre><ol start="9">
<li>获取计算机组成或模型信息——Get-WmiObject -Class Win32_ComputerSystem</li>
<li>获取当前计算机的BIOS信息——Get-WmiObject -Class Win32_BIOS -ComputerName .</li>
<li>列出所安装的修复程序（如QFE或Windows Update文件）——Get-WmiObject -Class Win32_QuickFixEngineering -ComputerName .</li>
<li>获取当前登录计算机的用户的用户名—— Get-WmiObject -Class Win32_ComputerSystem -Property UserName -ComputerName .</li>
<li>获取当前计算机所安装的应用的名字——Get-WmiObject -Class Win32_Product -ComputerName . | Format-Wide -Column 1</li>
<li>获取分配给当前计算机的IP地址——Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter IPEnabled=TRUE -ComputerName . | Format-Table -Property IPAddress</li>
<li>获取当前机器详细的IP配置报道——Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter IPEnabled=TRUE -ComputerName . | Select-Object -Property [a-z]* -ExcludeProperty IPX<em>,WINS</em></li>
<li>找到当前计算机上使用DHCP启用的网络卡——Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter “DHCPEnabled=true” -ComputerName .</li>
<li>在当前计算机上的所有网络适配器上启用DHCP——Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter IPEnabled=true -ComputerName . | ForEach-Object -Process {$_.EnableDHCP()}</li>
</ol>
<p>　　<strong>软件管理</strong></p>
<p>　　18. 在远程计算机上安装MSI包——(Get-WMIObject -ComputerName TARGETMACHINE -List | Where-Object -FilterScript {$_.Name -eq “Win32_Product”}).Install(\MACHINEWHEREMSIRESIDES\path\package.msi)<br>　　19. 使用基于MSI的应用升级包升级所安装的应用——(Get-WmiObject -Class Win32_Product -ComputerName . -Filter “Name=’name_of_app_to_be_upgraded’”).Upgrade(\MACHINEWHEREMSIRESIDES\path\upgrade_package.msi)<br>　　20. 从当前计算机移除MSI包——(Get-WmiObject -Class Win32_Product -Filter “Name=’product_to_remove’” -ComputerName . ).Uninstall()<br>　　机器管理<br>　　21. 一分钟后远程关闭另一台机器——Start-Sleep 60; Restart-Computer –Force –ComputerName TARGETMACHINE<br>　　22. 添加打印机——(New-Object -ComObject WScript.Network).AddWindowsPrinterConnection(\printerserver\hplaser3)<br>　　23. 移除打印机——(New-Object -ComObject WScript.Network).RemovePrinterConnection(“\printerserver\hplaser3 “)<br>　　24. 进入PowerShell会话——invoke-command -computername machine1, machine2 -filepath c:\Script\script.ps1</p>
<h2 id="powershell渗透工具"><a href="#powershell渗透工具" class="headerlink" title="powershell渗透工具"></a>powershell渗透工具</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">nishang</span><br><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_37438418&#x2F;article&#x2F;details&#x2F;80327624</span><br><span class="line"></span><br><span class="line">Empire	PowerShell后期漏洞利用代理工具</span><br><span class="line">不多说 给链接 实战中有时候比msf更好用</span><br><span class="line">http:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;76892.html</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;EmpireProject&#x2F;Empire</span><br><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;a1453514850&#x2F;article&#x2F;details&#x2F;88102779</span><br><span class="line"></span><br><span class="line">绕过PowerShell Execution Policy</span><br><span class="line">https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;system&#x2F;93829.html</span><br><span class="line"></span><br><span class="line">PowerSploit上面有很多powershell攻击脚本，它们主要被用来渗透中的信息侦察、权限提升、权限维持。</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;PowerShellMafia&#x2F;PowerSploit</span><br><span class="line">具体利用</span><br><span class="line">https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;263</span><br><span class="line">https:&#x2F;&#x2F;www.secpulse.com&#x2F;archives&#x2F;55893.html</span><br><span class="line"></span><br><span class="line">其它姿势</span><br><span class="line">http:&#x2F;&#x2F;www.freebuf.com&#x2F;sectool&#x2F;90362.html</span><br><span class="line">http:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;system&#x2F;133640.html</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">powershell取证</span><br><span class="line">http:&#x2F;&#x2F;bobao.360.cn&#x2F;learning&#x2F;detail&#x2F;570.html</span><br><span class="line"></span><br><span class="line">powershell对日志分析</span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;xiaozi&#x2F;p&#x2F;9284138.html</span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2019-12-31T10:04:35.057Z" itemprop="dateUpdated">2019-12-31 18:04:35</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" target="_blank" rel="external">http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/</a>
        
    </div>
    
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/avatar.jpg" alt="熊猫在路上">
            熊猫在路上
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&title=《第三周/12.31》 — 熊猫在路上&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&title=《第三周/12.31》 — 熊猫在路上&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《第三周/12.31》 — 熊猫在路上&url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/01/02/%E7%AC%AC%E4%B8%89%E5%91%A8/1.2/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">第三周/1.2</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/12/30/%E7%AC%AC%E4%B8%89%E5%91%A8/12.30/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">第三周/12.30</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>熊猫在路上 &copy; 2015 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&title=《第三周/12.31》 — 熊猫在路上&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&title=《第三周/12.31》 — 熊猫在路上&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《第三周/12.31》 — 熊猫在路上&url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://yoursite.com/2019/12/31/%E7%AC%AC%E4%B8%89%E5%91%A8/12.31/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '熊猫已经不再路上了！';
            clearTimeout(titleTime);
        } else {
            document.title = '熊猫在路上!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
